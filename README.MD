# Guide for Integrating xseed.sh with Sonarr and Radarr

This guide provides step-by-step instructions to integrate the `xseed.sh` script with Sonarr and Radarr, ensuring automated cross-seeding functionality upon media imports and upgrades.


NOTE: If you want xseed to trigger on single episode downloads from Usenet, use [xseed_episode.sh](https://github.com/theneedforseed/xseed_guide/blob/main/xseed_episode.sh)

---

## Prerequisites

1. **Cross-Seed Application**
   - Ensure that the cross-seed application is installed and configured. 
   - For more information, visit the [cross-seed GitHub repository](https://github.com/mmgoodnow/cross-seed).

2. **Sonarr and/or Radarr**
   - These applications should be installed and properly configured to manage your media libraries.

3. **Download Clients**
   - Supported BitTorrent clients like qBittorrent or Usenet clients such as SABnzbd should be set up and connected to your *arr applications.

---

## Step-by-Step Guide

### 1. Download the `xseed.sh` Script

- Access the script from the provided GitHub Gist: [xseed.sh](https://gist.github.com/zakkarry/ddc337a37b038cb84e6248fe8adebb46).
- Save the script to your *arr application's configuration directory. For example:
  - **Sonarr:** `/mnt/user/appdata/sonarr/xseed.sh`
  - **Radarr:** `/mnt/user/appdata/radarr/xseed.sh`

Placing the script in the configuration directory ensures it's accessible within the Docker container without the need to modify volume mounts.

---

### 2. Configure the Script

- Create an `.env` file in the same directory with the following content:

```ini
TORRENT_CLIENTS="qbittorrent"
USENET_CLIENTS="sabnzbd" 
XSEED_HOST="cross-seed" ### If Sonarr and cross-seed is not on the same docker network, use your LAN IP here.
XSEED_PORT=2468
LOG_FILE="/config/xseed.log"
LOGID_FILE="/config/xseed-id.log"
XSEED_APIKEY=""
```

Adjust the values to match your environment. Ensure that the client names (`TORRENT_CLIENTS` and `USENET_CLIENTS`) correspond exactly to how they are named in your *arr applications. Values are case sensitive.

---

### 3. Obtain the Cross-Seed API Key

To allow the `xseed.sh` script to communicate with the cross-seed daemon, you'll need to retrieve the API key generated by cross-seed.

#### Steps

1. **Extract the api-key from the cross-seed docker container:**

   ```sh
   docker exec -it [cross-seed] cross-seed api-key   
   ```

   Replace `[cross-seed]` with the actual name of your cross-seed container if it's different.

2. **Update the `.env` File:**

   ```ini
   XSEED_APIKEY="your_api_key_here"
   ```

   Save and close the `.env` file.

---

### 4. Set Permissions

- Ensure the script has execute permissions. Run the following command:

  ```sh
  chmod +x /mnt/user/appdata/sonarr/xseed.sh
  ```

  ```sh
  chmod +x /mnt/user/appdata/radarr/xseed.sh
  ```

  Replace the path with the actual location of your `xseed.sh` script.

---

### 5. Integrate with *arr Applications

#### Sonarr

- Navigate to `Settings` > `Connect`.
- Click on `+` to add a new connection and select `Custom Script`.
- Configure the custom script as follows:
  - **Name:** `xseed`
  - **Path:** `/config/xseed.sh` (This path is relative to the Docker container's filesystem)
  - **Arguments:** Leave blank unless specific arguments are required.
  - **Triggers:** Enable the following option:
    - **On Import Complete:** This ensures the script runs after a new episode is imported.
- Save the connection.

#### Radarr

- Navigate to `Settings` > `Connect`.
- Click on `+` to add a new connection and select `Custom Script`.
- Configure the custom script similarly to Sonarr:
  - **Name:** `xseed`
  - **Path:** `/config/xseed.sh` (This path is relative to the Docker container's filesystem)
  - **Arguments:** Leave blank unless specific arguments are required.
  - **Triggers:** Enable the following options:
    - **On Import:** This ensures the script runs after a new movie is imported.
    - **On Upgrade:** This allows the script to execute when an existing movie is upgraded to a better quality.
- Save the connection.

---

### 6. Testing

- To ensure the script is functioning correctly, perform a test import in Sonarr or Radarr.
- After the import completes, check the log file specified in the configuration (e.g., `/config/xseed.log`) for entries indicating that the script executed successfully.

---

## Additional Notes

- **Logging:** The script logs its activities to the specified log file. Regularly monitor this file to ensure that the script operates as expected.
- **API Key:** If your cross-seed instance requires an API key, ensure it is set in the `.env` file or directly in the script.
- **Sonarr Version Compatibility:** This script is updated for season pack support from Usenet in cross-seed v6 only. Ensure you are using cross-seed v6 or later.
- **Event Type Configuration:** To enable this feature, you must switch to the "On Import Complete" event type in your Sonarr settings.

By following this guide, you should have the `xseed.sh` script integrated seamlessly with your Sonarr and Radarr setups, enhancing your media management with automated cross-seeding capabilities.

